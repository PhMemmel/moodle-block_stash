{"version":3,"file":"item-selector-dialogue.min.js","sources":["../src/item-selector-dialogue.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Dialogue for picking an item\n *\n * @copyright  2019 Adrian Greeve <adriangreeve.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine([\n    'jquery',\n    'block_stash/dialogue-base',\n    'core/templates',\n    'core/ajax',\n    'core/str'\n], function($, DialogueBase, Templates, Ajax, Str) {\n\n    /**\n     * A dialogue to show a user's item\n     *\n     * @param {int} userid The user id.\n     * @param {int} courseid The course id.\n     * @param {string} sesskey Session key.\n     * @param {Array} warnings List of warnings.\n     */\n    function ItemSelector(userid, courseid, sesskey, warnings) {\n        this._userid = userid;\n        this._courseid = courseid;\n        this._sesskey = sesskey;\n        this._warnings = warnings;\n        DialogueBase.prototype.constructor.apply(this, []);\n    }\n    ItemSelector.prototype = Object.create(DialogueBase.prototype);\n    ItemSelector.prototype.constructor = ItemSelector;\n\n    ItemSelector.prototype._userid = null;\n    ItemSelector.prototype._courseid = null;\n    ItemSelector.prototype._sesskey = null;\n    ItemSelector.prototype._warnings = null;\n\n    /**\n     * Render the ItemSelector.\n     *\n     * @method _render\n     * @return {Promise}\n     */\n    ItemSelector.prototype._render = function() {\n\n        // Need to go fetch all items for display.\n        var ajaxpromise = Ajax.call([{\n            methodname: 'block_stash_get_items',\n            args: {\n                courseid: this._courseid\n            }\n        }]);\n        var stringpromise = Str.get_string('additem', 'block_stash');\n        return $.when(ajaxpromise[0], stringpromise).then((ajaxvalues, stringvalues) => {\n            var context = {\n                userid: this._userid,\n                courseid: this._courseid,\n                items: ajaxvalues.items,\n                sesskey: this._sesskey,\n                warnings: this._warnings\n            };\n            Templates.render('block_stash/item_select_dialogue', context).then((html, js) => {\n                this.setTitle(stringvalues);\n                this._setDialogueContent(html);\n                this.center();\n                Templates.runTemplateJS(js);\n            });\n        });\n    };\n\n    return /** @alias module:block_stash/drop-snippet-dialogue */ ItemSelector;\n\n});"],"names":["define","$","DialogueBase","Templates","Ajax","Str","ItemSelector","userid","courseid","sesskey","warnings","_userid","_courseid","_sesskey","_warnings","prototype","constructor","apply","this","Object","create","_render","ajaxpromise","call","methodname","args","stringpromise","get_string","when","then","ajaxvalues","stringvalues","context","items","render","html","js","setTitle","_setDialogueContent","center","runTemplateJS"],"mappings":";;;;;;AAsBAA,4CAAO,CACH,SACA,4BACA,iBACA,YACA,aACD,SAASC,EAAGC,aAAcC,UAAWC,KAAMC,cAUjCC,aAAaC,OAAQC,SAAUC,QAASC,eACxCC,QAAUJ,YACVK,UAAYJ,cACZK,SAAWJ,aACXK,UAAYJ,SACjBR,aAAaa,UAAUC,YAAYC,MAAMC,KAAM,WAEnDZ,aAAaS,UAAYI,OAAOC,OAAOlB,aAAaa,WACpDT,aAAaS,UAAUC,YAAcV,aAErCA,aAAaS,UAAUJ,QAAU,KACjCL,aAAaS,UAAUH,UAAY,KACnCN,aAAaS,UAAUF,SAAW,KAClCP,aAAaS,UAAUD,UAAY,KAQnCR,aAAaS,UAAUM,QAAU,eAGzBC,YAAclB,KAAKmB,KAAK,CAAC,CACzBC,WAAY,wBACZC,KAAM,CACFjB,SAAUU,KAAKN,cAGnBc,cAAgBrB,IAAIsB,WAAW,UAAW,sBACvC1B,EAAE2B,KAAKN,YAAY,GAAII,eAAeG,MAAK,CAACC,WAAYC,oBACvDC,QAAU,CACVzB,OAAQW,KAAKP,QACbH,SAAUU,KAAKN,UACfqB,MAAOH,WAAWG,MAClBxB,QAASS,KAAKL,SACdH,SAAUQ,KAAKJ,WAEnBX,UAAU+B,OAAO,mCAAoCF,SAASH,MAAK,CAACM,KAAMC,WACjEC,SAASN,mBACTO,oBAAoBH,WACpBI,SACLpC,UAAUqC,cAAcJ,WAK0B9B"}